---
title: "Fuel Price Analysis in Western Australia"
subtitle: "FuelWatch Product Comparison Project"
author: "Stephen Tambi"
abstract: "This report analyzes fuel price data from the Western Australia FuelWatch API. It compares different fuel products to identify price differences and market patterns."
format:
  html:
    toc: true
    toc-depth: 3
    standalone: true
    embed-resources: true
    code-fold: false
    code-tools: false
execute:
  echo: false
  warning: false
  message: false
---

## Introduction


In this section describe: 
This project analyzes product data from FuelWatch to understand how different fuel products (like Unleaded, Diesel, and LPG) vary in price and availability across Western Australia. The goal is to identify which products are most common, which have the highest or lowest average prices, and how product type affects fuel cost.

This project uses data from the FuelWatch API, which provides daily fuel price information for different products such as Unleaded, Diesel, and LPG across Western Australia. The dataset includes details like product type, brand, price, and location.

The data comes directly from the Government of Western Australia’s FuelWatch service. Fuel stations are required by law to report their daily prices to FuelWatch, which then publishes the information through a public API. The data was collected automatically using this API and imported into R for analysis.
...


## Data 
 

The dataset was imported directly from the **Western Australia FuelWatch API, which provides daily fuel price data for different products such as Unleaded Petrol, Diesel, LPG, and AdBlue.  

A loop was used to download data for all product codes (1–10) using the API endpoint:  
`https://www.fuelwatch.wa.gov.au/fuelwatch/fuelWatchRSS?Product=CODE`.  

Each product feed was read into R using the xml2 package, converted into a table with **tibble()**, and combined into one dataset using **map_dfr()**.  

After importing, the data was cleaned with **tidyverse** functions to remove missing values, trim spaces, and standardize text. The final dataset, `fuel_clean`, contains **2392 rows × 5 columns** with variables for title, price, product, brand, and suburb.  

This process ensures the data is up‑to‑date and collected automatically from the official government source. 



```{r}
#| message: false
#| warning: false
# --- Load Packages ---
library(tidyverse)
library(xml2)

# --- Define Product Codes and Names ---
products <- tibble(
  code = c(1, 2, 4, 5, 6, 7, 8, 9, 10),
  name = c("Unleaded Petrol", "Premium Unleaded", "Diesel", "LPG",
           "98 RON", "E85", "B20", "Brand Diesel", "AdBlue")
)

# --- Download Data for Each Product ---
fuel_df <- map_dfr(products$code, function(p) {
  url <- paste0("https://www.fuelwatch.wa.gov.au/fuelwatch/fuelWatchRSS?Product=", p)
  data <- xml2::read_xml(url)
  items <- xml_find_all(data, ".//item")
  tibble(
    title = xml_text(xml_find_first(items, "title")),
    price = as.numeric(xml_text(xml_find_first(items, "price"))),
    product = products$name[products$code == p],
    brand = xml_text(xml_find_first(items, "brand")),
    suburb = xml_text(xml_find_first(items, "location"))
  )
})

# --- Preview Dataset ---
head(fuel_df)
nrow(fuel_df)

# --- Data Cleaning ---
fuel_clean <- fuel_df %>%
  mutate(
    price = as.numeric(price),
    brand = str_trim(brand),
    suburb = str_to_title(str_trim(suburb)),
    product = str_trim(product)
  ) %>%
  filter(!is.na(price))

# --- Preview Cleaned Data ---
head(fuel_clean)
summary(fuel_clean$price)

# --- Export Cleaned Dataset to CSV ---
write.csv(fuel_clean, "fuel_clean.csv", row.names = FALSE)
```

## Analysis

The analysis focused on comparing fuel prices across different product types in Western Australia. The cleaned dataset contained 2392 records from multiple fuel stations and brands.

First, the average price by product was calculated to identify which fuel types were cheapest or most expensive. The results showed that Unleaded Petrol and Premium Unleaded had lower average prices, while Diesel and LPG were slightly higher.

Next, a price distribution plot was created to visualize how prices vary across products. Most prices clustered between 170 and 190 cents per litre, showing a stable market with small variations.

Overall, the analysis shows that fuel prices differ mainly by product type, while brand and region have smaller impacts.Yes. I see your screen.
-->
  


```{r}
# --- Analysis: Average Fuel Price by Product ---
avg_product <- fuel_clean %>%
  group_by(product) %>%
  summarise(avg_price = mean(price)) %>%
  arrange(avg_price)

# --- Visualization: Average Fuel Price by Product ---
ggplot(avg_product, aes(x = reorder(product, avg_price), y = avg_price)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(title = "Average Fuel Price by Product",
       x = "Product",
       y = "Average Price (cents per litre)")

       # --- Analysis: Average Price by Brand and Product ---
avg_brand_product <- fuel_clean %>%
  group_by(product, brand) %>%
  summarise(avg_price = mean(price)) %>%
  arrange(product, avg_price)

# --- Visualization ---
ggplot(avg_brand_product, aes(x = reorder(brand, avg_price), y = avg_price, fill = product)) +
  geom_col() +
  coord_flip() +
  labs(title = "Average Fuel Price by Brand and Product",
       x = "Brand",
       y = "Average Price (cents per litre)",
       fill = "Product")

       # --- Visualization: Price Distribution by Product ---
ggplot(fuel_clean, aes(x = price, fill = product)) +
  geom_histogram(bins = 30, alpha = 0.7, position = "identity") +
  labs(title = "Fuel Price Distribution by Product",
       x = "Price (cents per litre)",
       y = "Number of Stations",
       fill = "Product")
```

  
```{r}
# --- Statistical Analysis: ANOVA Test for Price Differences by Product ---
anova_result <- aov(price ~ product, data = fuel_clean)
summary(anova_result)
```

<!-- There can be more chunks of your choice--> The ANOVA test shows a significant difference in mean fuel prices across product types (F = 584.1, p < 0.001). This confirms that fuel type has a strong effect on pricing in Western Australia Finally, a statistical analysis (ANOVA) was performed to test whether the differences in average prices between products were significant. The ANOVA results (F = 584.1, p < 0.001) confirmed that product type has a significant effect on fuel price.


## Conclusion

The analysis shows that fuel prices in Western Australia vary mainly by product type. The ANOVA test confirmed a significant difference in mean prices across products (F = 584.1, p < 0.001), meaning fuel type strongly affects price.

Unleaded Petrol and Premium Unleaded are generally cheaper, while Diesel and LPG are more expensive. Prices mostly range between 170 and 190 cents per litre, showing a stable market.

The dataset is reliable because it comes directly from the Western Australia FuelWatch API, which collects official daily submissions from fuel stations. Overall, product type is the main factor influencing fuel prices, while brand and suburb have smaller effects. 



